(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-02668dd6"],{1:function(t,e){},2:function(t,e){},2783:function(t,e,i){},"2b54":function(t,e,i){"use strict";i.r(e);var n=i("9511"),a=i.n(n),s=i("bc3a"),o=i.n(s),r=i("968b"),l=(i("9a26"),{name:"ShowPdf",props:["pdfUrl","pdfInfo"],data:function(){return{scale:1.2,totals:[],pageNo:1,viewHeight:0,scrollbar:""}},mounted:function(){this.scrollbar=this.$refs.elscrollbar.$refs.wrap,this.scrollbar.addEventListener("scroll",this.scrollfun,!1),this.getMainContentWidth(),this.getPdfFun(),a.a.GlobalWorkerOptions.workerSrc="pdfjs-dist/build/pdf.worker.js"},methods:{getPdfFun:function(){var t=this;o()({method:"get",url:this.pdfUrl,data:{},responseType:"blob"}).then(function(e){var i=window.URL.createObjectURL(new Blob([e.data]));t.renderPdf(i)})},getMainContentWidth:function(){var t=this.$refs.mainContent,e=window.getComputedStyle(t).width;this.contentWidth=parseInt(e)},renderPdf:function(t){var e=this;a.a.workerSrc=i("2aad"),a.a.getDocument(t).then(function(t){var i=t.numPages;e.createCanvas(i,"canvas-pdf-");for(var n=function(i){t.getPage(i).then(function(t){var n=document.getElementById("page-".concat(i)),a=t.getViewport(1),s=e.contentWidth/a.width,o=t.getViewport(s),l=document.getElementById("canvas-pdf-"+i),c=l.getContext("2d");l.height=o.height,l.width=o.width,e.viewHeight=o.height;var d={canvasContext:c,viewport:o};t.render(d).then(function(){return t.getTextContent()}).then(function(e){var i=document.createElement("div");i.setAttribute("class","textLayer"),n.appendChild(i);var a=new r.TextLayerBuilder({textLayerDiv:i,pageIndex:t.pageIndex,viewport:o});a.setTextContent(e),a.render()})})},a=1;a<=i;a++)n(a)})},createCanvas:function(t){for(var e=1;e<=t;e++)this.totals.push(e)},scrollfun:function(t){var e=t.target.scrollTop;this.pageNo=0===e?1:Math.ceil((e+15)/this.viewHeight)},pageUp:function(){var t=this.totals.length;this.pageNo>0&&(this.scrollbar.scrollTop=(this.pageNo-2)*(this.scrollbar.scrollHeight/t))},pageDown:function(){var t=this.totals.length;this.pageNo<t&&(this.scrollbar.scrollTop=this.pageNo*(this.scrollbar.scrollHeight/t))}}}),c=(i("5038"),i("2877")),d=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"showPdf"}},[i("el-scrollbar",{ref:"elscrollbar",staticStyle:{height:"800px","overflow-y":"hidden"}},[i("div",{staticClass:"position page"},[i("span",{staticClass:"span_1",on:{click:t.pageUp}},[t._v("上一页")]),t._v(" "),i("span",[t._v("页码："+t._s(t.pageNo+"/"+t.totals.length))]),t._v(" "),i("span",{staticClass:"span_2",on:{click:t.pageDown}},[t._v("下一页")])]),t._v(" "),i("div",{staticClass:"position info"},[i("span",{staticClass:"span_1"},[t._v("上传者："+t._s(t.pdfInfo.updateBy))]),t._v(" "),i("span",[t._v("上传时间："+t._s(t.pdfInfo.updateOn))]),t._v(" "),i("span",{staticClass:"span_2"},[t._v("附件编号："+t._s(t.pdfInfo.workNo))])]),t._v(" "),i("div",{ref:"mainContent",staticClass:"main_content",attrs:{id:"mainContent"}},t._l(t.totals,function(t){return i("div",{key:t,staticClass:"pdf-box",attrs:{id:"page-"+t}},[i("canvas",{staticClass:"canvas-pdf",attrs:{id:"canvas-pdf-"+t}})])}),0)])],1)},[],!1,null,null,null).exports,h={name:"CPdf",props:["pdfurl"],data:function(){return{pdfDoc:null,pageNum:1,pageRendering:!1,pageNumPending:null,scale:1.2,page_num:0,page_count:0,maxscale:2,minscale:.8}},methods:{renderPage:function(t){var e=this;this.pageRendering=!0;var i=document.getElementById("the-canvas");this.pdfDoc.getPage(t).then(function(t){var n=t.getViewport(e.scale);i.height=n.height,i.width=n.width;var a={canvasContext:e.ctx,viewport:n};t.render(a).promise.then(function(){e.pageRendering=!1,null!==e.pageNumPending&&(e.renderPage(e.pageNumPending),e.pageNumPending=null)})}),e.page_num=e.pageNum},addscale:function(){this.scale>=this.maxscale||(this.scale+=.1,this.queueRenderPage(this.pageNum))},minus:function(){this.scale<=this.minscale||(this.scale-=.1,this.queueRenderPage(this.pageNum))},prev:function(){this.pageNum<=1||(this.pageNum--,this.queueRenderPage(this.pageNum))},next:function(){var t=this;t.pageNum>=t.page_count||(t.pageNum++,t.queueRenderPage(t.pageNum))},closepdf:function(){this.$emit("closepdf")},queueRenderPage:function(t){this.pageRendering?this.pageNumPending=t:this.renderPage(t)}},computed:{ctx:function(){return document.getElementById("the-canvas").getContext("2d")}},mounted:function(){var t=this;a.a.GlobalWorkerOptions.workerSrc="pdfjs-dist/build/pdf.worker.js",a.a.getDocument(t.pdfurl).then(function(e){t.pdfDoc=e,t.page_count=t.pdfDoc.numPages,t.renderPage(t.pageNum)})}},p=(i("9c1b"),{components:{CPdf:Object(c.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cpdf"},[i("div",{staticClass:"center"},[i("div",{staticClass:"contor"},[i("el-button",{on:{click:t.prev}},[t._v("上一页")]),t._v(" "),i("el-button",{on:{click:t.next}},[t._v("下一页")]),t._v(" "),i("span",[t._v("Page: "),i("span",{domProps:{textContent:t._s(t.page_num)}}),t._v(" / "),i("span",{domProps:{textContent:t._s(t.page_count)}})]),t._v(" "),i("el-button",{attrs:{icon:"plus"},on:{click:t.addscale}}),t._v(" "),i("el-button",{attrs:{icon:"minus"},on:{click:t.minus}}),t._v(" "),i("el-button",{attrs:{id:"prev"},on:{click:t.closepdf}},[t._v("关闭")])],1),t._v(" "),i("canvas",{staticClass:"canvasstyle",attrs:{id:"the-canvas"}})])])},[],!1,null,"3dedab61",null).exports,ShowPdf:d},data:function(){return{baseURL:"http://192.100.2.64:19252",iframeState:!1,iframeWidth:"",iframeHigh:"",iframeStyle:"",iframeSign:"http://localhost:9000/px-sign/signs",iframePdf:"http://localhost:9000/px-sign/pdfView",dialogVisible:!0,dialogSignVisible:!0,dialogShow:!1,dialogSingleShow:!1,dialogTestVisible:!1,pdfDoc:{numPages:0},pdfUrl:"http://localhost:9000/px-sign/file/ceshi.pdf",pdfInfo:{updateBy:"张三",updateOn:"上传时间",workNo:"001"},pdfurl:"http://localhost:9000/px-sign/file/ceshi.pdf"}},methods:{getPlace:function(t,e,i,n){alert(t)},sealStart:function(){this.dialogSingleShow=!0,this.dialogVisible=!0,this.iframePdf=this.baseURL+"px-sign/pdfView";var t=document.body.scrollWidth,e=document.body.scrollHeight;t<985&&(t=985),this.iframeStyle="",this.iframeWidth=.9*t,this.iframeHigh=.78*e},pSealStart:function(){this.dialogShow=!0,this.dialogSignVisible=!0;var t=["1","2","3"];this.iframeSign=this.baseURL+"px-sign/signs?doc="+t+"&module=powerTrade";var e=document.body.scrollWidth,i=document.body.scrollHeight,n=window.screen.height,a=window.screen.width;this.iframeStyle="position:relative;top: "+.05*n+";left: "+.05*a,e<985&&(e=985),this.iframeWidth=.9*e,this.iframeHigh=.8*i,this.$refs.signs.contentWindow.postMessage({cmd:"getFormJson",params:{doc:t}},"*")},pSealStart1:function(){var t=document.body.scrollWidth,e=document.body.scrollHeight;t<985&&(t=985);var i=window.screen.height,n=window.screen.width;window.open(this.baseURL+"px-sign/signs?doc="+["1","2","3"]+"&module=powerTrade","_search","height="+.9*e+", width="+.9*t+", top="+.05*i+", left="+.05*n)},handleClose:function(){this.dialogVisible=!1},handleSignClose:function(){this.iframeSign="",this.dialogSignVisible=!1},handleTestClose:function(){},handleMessage:function(t){t.data.cmd},sealStart1:function(){this.dialogTestVisible=!0}},mounted:function(){window.addEventListener("message",this.handleMessage),this.dialogSignVisible=!1,this.dialogVisible=!1}}),u=Object(c.a)(p,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("el-main",[i("el-button",{attrs:{type:"primary",icon:"el-icon-tickets",size:"small"},on:{click:function(e){return t.sealStart()}}},[t._v("签章")]),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-tickets",size:"small"},on:{click:function(e){return t.sealStart1()}}},[t._v("签章")]),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-tickets",size:"small"},on:{click:function(e){return t.pSealStart()}}},[t._v("批量签章")]),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-tickets",size:"small"},on:{click:function(e){return t.pSealStart1()}}},[t._v("批量签章")]),t._v(" "),[i("el-dialog",{attrs:{title:"新一代交易平台电子签章",visible:t.dialogVisible,width:"95%",top:"5px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("iframe",{ref:"child",style:t.iframeStyle,attrs:{src:t.iframePdf,width:t.iframeWidth,height:t.iframeHigh,frameborder:"0"}})])],t._v(" "),[i("el-dialog",{attrs:{visible:t.dialogSignVisible,width:"95%",top:"5px","before-close":t.handleSignClose,center:""},on:{"update:visible":function(e){t.dialogSignVisible=e}}},[i("iframe",{ref:"signs",style:t.iframeStyle,attrs:{src:t.iframeSign,width:t.iframeWidth,height:t.iframeHigh,frameborder:"0"}})])]],2)],1)},[],!1,null,"409162db",null);e.default=u.exports},3:function(t,e){},4:function(t,e){},5038:function(t,e,i){"use strict";var n=i("f33d");i.n(n).a},"9c1b":function(t,e,i){"use strict";var n=i("2783");i.n(n).a},f33d:function(t,e,i){}}]);